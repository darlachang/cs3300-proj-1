<html>
<head>
<title>Project1</title>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/default.min.css">
<link href="https://fonts.googleapis.com/css?family=Alegreya|Alegreya+Sans" rel="stylesheet">
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
<style>

svg { border: solid #ccc 1px; }

</style>
</head>
<body>
<div>

<svg>
</svg>

<script>
var svg = d3.select("svg");

var padding = {left:20, right: 80, top:80, bottom:20};

var width = 1200;
var countryData;
var height = 100*100;

svg.attr("width", width)
   .attr("height", height);

d3.tsv("country.tsv", function (error, data) {
	if(error) { console.log(error);}


	countryData = data.map(function(d){
		country = d.Country;
		population = d.pop2015;
		size = d.landSqMi;
		best = d.numOneFor;
		gdp = d.GDP;
		gdpcapita=d.GDPperCapita;
		return {"name":country, 
		"pop": population,
		"best": best,
		"gdp": gdp,
		"gdpcapita": gdpcapita};
	});

	countryData = countryData.filter(function (d) {return +d.gdp !=0;})
	console.log("countryData",countryData);
	showBubble(countryData);

});


function showBubble(data){

	var gdpScale = d3.scaleLinear()
					.domain([984074074,18036648000000])
					.range([30,120]);
	var gdpCapScale = d3.scaleLinear()
					.domain([277,101450])
					.range([0,10]);

	var colors = ["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"]
	var gdpCapColor = d3.scaleOrdinal()
					.domain([0,2,4,6,8,10])
					.range(colors);

	for(var i=0; i<data.length; i++){

	svg.append("circle")
	.attr("cx", 200*parseInt(i%5)+80)
	.attr("cy", parseInt(i/5)*160)
	.attr("transform","translate(" + padding.left + "," + padding.top + ")")
	.text(data[i].name)
	.attr("r",gdpScale(data[i].gdp))
	.style("fill", gdpCapColor(Math.ceil(gdpCapScale(data[i].gdpcapita))+Math.ceil(gdpCapScale(data[i].gdpcapita))%2)); //round up to next even number

	svg.append("text")
	.attr("x", 200*parseInt(i%5)+80)
	.attr("y", parseInt(i/5)*160)
	.attr("transform","translate(" + padding.left + "," + padding.top + ")")
	.text(data[i].best)
	.style("font-size",15)
	.style("font-family","Alegreya")
	.style("text-anchor","middle")
	.style("fill", "black");

	svg.append("text")
	.attr("x", 200*parseInt(i%5)+80)
	.attr("y", parseInt(i/5)*160+10)
	.attr("transform","translate(" + padding.left + "," + padding.top + ")")
	.text(data[i].name)
	.style("text-anchor","middle")
	.style("font-size",10)
	.style("fill", "black");

//might need to group elements later!


	}
}
</script>



</body>
</html>
